 select 	l_returnflag, 	l_linestatus, 	sum(l_quantity) as sum_qty, 	sum(l_extendedprice) as sum_base_price, 	sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, 	sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, 	avg(l_quantity) as avg_qty, 	avg(l_extendedprice) as avg_price, 	avg(l_discount) as avg_disc, 	count(*) as count_order from 	lineitem where 	l_shipdate <= date '1998-12-01' - interval '3 day' group by 	l_returnflag, 	l_linestatus order by 	l_returnflag, 	l_linestatus; 
select 	s_acctbal, 	s_name, 	n_name, 	p_partkey, 	p_mfgr, 	s_address, 	s_phone, 	s_comment from 	part, 	supplier, 	partsupp, 	nation, 	region where 	p_partkey = ps_partkey 	and s_suppkey = ps_suppkey 	and p_size = 1 	and p_type like '%STEEL' 	and s_nationkey = n_nationkey 	and n_regionkey = r_regionkey 	and r_name = 'ASIA' 	and ps_supplycost = ( 		select 			min(ps_supplycost) 		from 			partsupp, 			supplier, 			nation, 			region 		where 			p_partkey = ps_partkey 			and s_suppkey = ps_suppkey 			and s_nationkey = n_nationkey 			and n_regionkey = r_regionkey 			and r_name = 'ASIA' 	) order by 	s_acctbal desc, 	n_name, 	s_name, 	p_partkey;  
 select 	l_orderkey, 	sum(l_extendedprice * (1 - l_discount)) as revenue, 	o_orderdate, 	o_shippriority from 	customer, 	orders, 	lineitem where 	c_mktsegment = 'AUTOMOBILE' 	and c_custkey = o_custkey 	and l_orderkey = o_orderkey 	and o_orderdate < date '1995-03-01' 	and l_shipdate > date '1995-03-01' group by 	l_orderkey, 	o_orderdate, 	o_shippriority order by 	revenue desc, 	o_orderdate LIMIT 1;  
 select 	o_orderpriority, 	count(*) as order_count from 	orders where 	o_orderdate >= date '1995-03-01' 	and o_orderdate < date '1995-03-01' + interval '3 month' 	and exists ( 		select 			* 		from 			lineitem 		where 			l_orderkey = o_orderkey 			and l_commitdate < l_receiptdate 	) group by 	o_orderpriority order by 	o_orderpriority LIMIT 1;  
 select 	n_name, 	sum(l_extendedprice * (1 - l_discount)) as revenue from 	customer, 	orders, 	lineitem, 	supplier, 	nation, 	region where 	c_custkey = o_custkey 	and l_orderkey = o_orderkey 	and l_suppkey = s_suppkey 	and c_nationkey = s_nationkey 	and s_nationkey = n_nationkey 	and n_regionkey = r_regionkey 	and r_name = 'AISA' 	and o_orderdate >= date '1995-03-01' 	and o_orderdate < date '1995-03-01' + interval '1 year' group by 	n_name order by 	revenue desc LIMIT 1;  
 select 	sum(l_extendedprice * l_discount) as revenue from 	lineitem where 	l_shipdate >= date '1995-03-01' 	and l_shipdate < date '1995-03-01' + interval '1 year' 	and l_discount between 0.05 - 0.01 and 0.05 + 0.01 	and l_quantity < 25.00 LIMIT 1;  
 select 	supp_nation, 	cust_nation, 	l_year, 	sum(volume) as revenue from 	( 		select 			n1.n_name as supp_nation, 			n2.n_name as cust_nation, 			extract(year from l_shipdate) as l_year, 			l_extendedprice * (1 - l_discount) as volume 		from 			supplier, 			lineitem, 			orders, 			customer, 			nation n1, 			nation n2 		where 			s_suppkey = l_suppkey 			and o_orderkey = l_orderkey 			and c_custkey = o_custkey 			and s_nationkey = n1.n_nationkey 			and c_nationkey = n2.n_nationkey 			and ( 				(n1.n_name = 'GERMANY' and n2.n_name = 'BRAZIL') 				or (n1.n_name = 'BRAZIL' and n2.n_name = 'GERMANY') 			) 			and l_shipdate between date '1995-01-01' and date '1996-12-31' 	) as shipping group by 	supp_nation, 	cust_nation, 	l_year order by 	supp_nation, 	cust_nation, 	l_year; -- LIMIT 1;  
 select 	o_year, 	sum(case 		when nation = 'GERMANY' then volume 		else 0 	end) / sum(volume) as mkt_share from 	( 		select 			extract(year from o_orderdate) as o_year, 			l_extendedprice * (1 - l_discount) as volume, 			n2.n_name as nation 		from 			part, 			supplier, 			lineitem, 			orders, 			customer, 			nation n1, 			nation n2, 			region 		where 			p_partkey = l_partkey 			and s_suppkey = l_suppkey 			and l_orderkey = o_orderkey 			and o_custkey = c_custkey 			and c_nationkey = n1.n_nationkey 			and n1.n_regionkey = r_regionkey 			and r_name = 'ASIA' 			and s_nationkey = n2.n_nationkey 			and o_orderdate between date '1995-01-01' and date '1996-12-31' 			and p_type = 'STANDARD BRUSHED TIN' 	) as all_nations group by 	o_year order by 	o_year  LIMIT 1;  
 select 	nation, 	o_year, 	sum(amount) as sum_profit from 	( 		select 			n_name as nation, 			extract(year from o_orderdate) as o_year, 			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount 		from 			part, 			supplier, 			lineitem, 			partsupp, 			orders, 			nation 		where 			s_suppkey = l_suppkey 			and ps_suppkey = l_suppkey 			and ps_partkey = l_partkey 			and p_partkey = l_partkey 			and o_orderkey = l_orderkey 			and s_nationkey = n_nationkey 			and p_name like '%lemon%' 	) as profit group by 	nation, 	o_year order by 	nation, 	o_year desc LIMIT 1;  
 select 	c_custkey, 	c_name, 	sum(l_extendedprice * (1 - l_discount)) as revenue 	c_acctbal, 	n_name, 	c_address, 	c_phone, 	c_comment from 	customer, 	orders, 	lineitem, 	nation where 	c_custkey = o_custkey 	and l_orderkey = o_orderkey 	and o_orderdate >= date '1995-03-01' 	and o_orderdate < date '1995-03-01' + interval '3' month 	and l_returnflag = 'R' 	and c_nationkey = n_nationkey group by 	c_custkey, 	c_name, 	c_acctbal, 	c_phone, 	n_name, 	c_address, 	c_comment order by 	revenue desc LIMIT 1;  
 select 	ps_partkey, 	sum(ps_supplycost * ps_availqty) as value from 	partsupp, 	supplier, 	nation where 	ps_suppkey = s_suppkey 	and s_nationkey = n_nationkey 	and n_name = 'GERMANY' group by 	ps_partkey having 		sum(ps_supplycost * ps_availqty) > ( 			select 				sum(ps_supplycost * ps_availqty) * 0.00004 			from 				partsupp, 				supplier, 					nation 			where 				ps_suppkey = s_suppkey 				and s_nationkey = n_nationkey 				and n_name = 'GERMANY' 		) order by 	value desc  LIMIT 1;  
 select 	l_shipmode, 	sum(case 		when o_orderpriority = '1-URGENT' 			or o_orderpriority = '2-HIGH' 			then 1 		else 0 	end) as high_line_count, 	sum(case 		when o_orderpriority <> '1-URGENT' 			and o_orderpriority <> '2-HIGH' 			then 1 		else 0 	end) as low_line_count from 	orders, 	lineitem where 	o_orderkey = l_orderkey 	and l_shipmode in ('RAIL', 'TRUCK') 	and l_commitdate < l_receiptdate 	and l_shipdate < l_commitdate 	and l_receiptdate >= date '1995-03-01' 	and l_receiptdate < date '1995-03-01' + interval '1' year group by 	l_shipmode order by 	l_shipmode  LIMIT 1;  
 select 	c_count, 	count(*) as custdist from 	( 		select 			c_custkey, 			count(o_orderkey) 		from 			customer left outer join orders on 				c_custkey = o_custkey 				and o_comment not like '%the%regular%' 		group by 			c_custkey 	) as c_orders (c_custkey, c_count) group by 	c_count order by 	custdist desc, 	c_count desc;  
 select 	100.00 * sum(case 		when p_type like 'PROMO%' 			then l_extendedprice * (1 - l_discount) 		else 0 	end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from 	lineitem, 	part where 	l_partkey = p_partkey 	and l_shipdate >= date '1995-03-01' 	and l_shipdate < date '1995-03-01' + interval '1' month;  
 select 	ps_partkey, 	sum(ps_supplycost * ps_availqty) as value from 	partsupp, 	supplier where 	ps_suppkey = s_suppkey group by 	ps_partkey having 		sum(ps_supplycost * ps_availqty) > ( 			select 				sum(ps_supplycost * ps_availqty) * 0.00004 			from 				partsupp, 				supplier 			where 				ps_suppkey = s_suppkey 		) order by 	value asc; 
 select 	p_brand, 	p_type, 	p_size, 	count(distinct ps_suppkey) as supplier_cnt from 	partsupp, 	part where 	p_partkey = ps_partkey 	and p_brand <> 'Brand#50' 	and p_type not like 'LARGE%' 	and p_size in (5, 7, 15, 18, 23, 36, 39, 45) 	and ps_suppkey not in ( 		select 			s_suppkey 		from 			supplier 		where 			s_comment like '%Customer%Complaints%' 	) group by 	p_brand, 	p_type, 	p_size order by 	supplier_cnt desc, 	p_brand, 	p_type, 	p_size;  
 select 	sum(l_extendedprice) / 7.0 as avg_yearly from 	lineitem, 	part where 	p_partkey = l_partkey 	and p_brand = 'Brand#25' 	and p_container = 'LG PACK' 	and l_quantity < ( 		select 			0.2 * avg(l_quantity) 		from 			lineitem 		where 			l_partkey = p_partkey 	);  
 select 	c_name, 	c_custkey, 	o_orderkey, 	o_orderdate, 	o_totalprice, 	sum(l_quantity) from 	customer, 	orders, 	lineitem where 	o_orderkey in ( 		select 			l_orderkey 		from 			lineitem 		group by 			l_orderkey having 				sum(l_quantity) > 100 	) 	and c_custkey = o_custkey 	and o_orderkey = l_orderkey group by 	c_name, 	c_custkey, 	o_orderkey, 	o_orderdate, 	o_totalprice order by 	o_totalprice desc, 	o_orderdate;  
 select 	sum(l_extendedprice* (1 - l_discount)) as revenue from 	lineitem, 	part where 	( 		p_partkey = l_partkey 		and p_brand = 'Brand#12' 		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') 		and l_quantity >= 10 and l_quantity <= 10 + 10 		and p_size between 1 and 5 		and l_shipmode in ('AIR', 'AIR REG') 		and l_shipinstruct = 'DELIVER IN PERSON' 	) 	or 	( 		p_partkey = l_partkey 		and p_brand = 'Brand#45' 		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') 		and l_quantity >= 20 and l_quantity <= 20 + 10 		and p_size between 1 and 10 		and l_shipmode in ('AIR', 'AIR REG') 		and l_shipinstruct = 'DELIVER IN PERSON' 	) 	or 	( 		p_partkey = l_partkey 		and p_brand = 'Brand#24' 		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') 		and l_quantity >= 30 and l_quantity <= 30 + 10 		and p_size between 1 and 15 		and l_shipmode in ('AIR', 'AIR REG') 		and l_shipinstruct = 'DELIVER IN PERSON' 	);  
 select 	s_name, 	s_address from 	supplier, 	nation where 	s_suppkey in ( 		select 			ps_suppkey 		from 			partsupp 		where 			ps_partkey in ( 				select 					p_partkey 				from 					part 				where 					p_name like 'almond%' 			) 			and ps_availqty > ( 				select 					0.5 * sum(l_quantity) 				from 					lineitem 				where 					l_partkey = ps_partkey 					and l_suppkey = ps_suppkey 					and l_shipdate >= date '1995-03-01' 					and l_shipdate < date '1995-03-01' + interval '1' year 			) 	) 	and s_nationkey = n_nationkey 	and n_name = 'GERMANY' order by 	s_name;  
 select 	s_name, 	count(*) as numwait from 	supplier, 	lineitem l1, 	orders, 	nation where 	s_suppkey = l1.l_suppkey 	and o_orderkey = l1.l_orderkey 	and o_orderstatus = 'F' 	and l1.l_receiptdate > l1.l_commitdate 	and exists ( 		select 			* 		from 			lineitem l2 		where 			l2.l_orderkey = l1.l_orderkey 			and l2.l_suppkey <> l1.l_suppkey 	) 	and not exists ( 		select 			* 		from 			lineitem l3 		where 			l3.l_orderkey = l1.l_orderkey 			and l3.l_suppkey <> l1.l_suppkey 			and l3.l_receiptdate > l3.l_commitdate 	) 	and s_nationkey = n_nationkey 	and n_name = 'GERMANY' group by 	s_name order by 	numwait desc, 	s_name;   
 select 	cntrycode, 	count(*) as numcust, 	sum(c_acctbal) as totacctbal from 	( 		select 			substring(c_phone from 1 for 2) as cntrycode, 			c_acctbal 		from 			customer 		where 			substring(c_phone from 1 for 2) in 				('12', '15', '18', '21', '24', '27', '30') 			and c_acctbal > ( 				select 					avg(c_acctbal) 				from 					customer 				where 					c_acctbal > 0.00 					and substring(c_phone from 1 for 2) in 						('12', '15', '18', '21', '24', '27', '30') 			) 			and not exists ( 				select 					* 				from 					orders 				where 					o_custkey = c_custkey 			) 	) as custsale group by 	cntrycode order by 	cntrycode;  
 SELECT p_partkey, 	ps_suppkey FROM part, partsupp WHERE p_name LIKE '%blush%';  
 SELECT p_partkey, 	avg(p_size) FROM part, partsupp WHERE p_name LIKE '%blush%' 	AND p_brand IN ('Brand#32', 'Brand#42', 'Brand#13') GROUP BY p_partkey;  
 select 	c_custkey, 	c_name, 	sum(l_extendedprice * (1 - l_discount)) as revenue from 	customer, 	orders, 	lineitem where 	c_custkey = o_custkey 	and l_orderkey = o_orderkey 	and l_returnflag = 'R' group by 	c_custkey, 	c_name, 	c_acctbal, 	c_phone order by 	revenue desc;  
 select 	c_custkey, 	c_name, 	n_name, 	sum(l_extendedprice * (1 - l_discount)) as revenue from 	customer, 	orders, 	lineitem, 	nation where 	c_custkey = o_custkey 	and l_orderkey = o_orderkey 	and l_returnflag = 'R' group by 	c_custkey, 	c_name, 	c_acctbal, 	c_phone, 	n_name order by 	revenue asc;  
 select 	avg(l_extendedprice) from 	lineitem, 	part where 	l_shipdate < date '1995-03-01' 	and p_partkey = l_partkey 	and p_brand LIKE '%2%' 	and p_container = 'LG PACK' 	and l_quantity < ( 		select 			0.2 * avg(l_quantity) 		from 			lineitem 		where 			l_partkey = p_partkey 	);  
 select 	c_name, 	c_custkey, 	o_orderkey, 	o_orderdate, 	o_totalprice from 	customer, 	orders, 	lineitem where 	o_orderkey not in ( 		select 			l_orderkey 		from 			lineitem 		group by 			l_orderkey having 				sum(l_quantity) > 100 	) 	and c_custkey = o_custkey 	and o_orderkey = l_orderkey group by 	c_name, 	c_custkey, 	o_orderkey, 	o_orderdate, 	o_totalprice order by 	o_totalprice desc, 	o_orderdate;  
 select 	l_orderkey, 	sum(l_extendedprice * (1 - l_discount)) as revenue, 	o_orderdate from 	customer, 	orders, 	lineitem where 	c_mktsegment = 'AUTOMOBILE' 	and c_custkey = o_custkey 	and l_orderkey = o_orderkey 	and o_orderdate < date '1995-03-01' 	and l_shipdate > date '1995-03-01' group by 	l_orderkey, 	o_orderdate order by 	revenue desc, 	o_orderdate LIMIT 1;  
 select 	l_orderkey, 	sum(l_extendedprice * (1 - l_discount)) as revenue, 	count(o_orderdate) from 	customer, 	orders, 	lineitem where 	c_mktsegment = 'AUTOMOBILE' 	and c_custkey = o_custkey 	and l_orderkey = o_orderkey 	and o_orderdate < date '1995-03-01' 	and l_shipdate > date '1995-03-01' group by 	l_orderkey, 	o_orderdate order by 	revenue desc, 	o_orderdate LIMIT 1;  
 select 	l_orderkey, 	sum(l_extendedprice * (1 - l_discount)) as revenue, 	count(o_orderdate) from 	orders, 	lineitem where 	l_orderkey = o_orderkey 	and o_orderdate < date '1995-03-01' 	and l_shipdate > date '1995-03-01' group by 	l_orderkey, 	o_orderdate order by 	revenue desc, 	o_orderdate;  
 select 	c_custkey, 	c_name, 	sum(l_extendedprice * (1 - l_discount)) as revenue, 	c_acctbal, 	n_name, 	c_address, 	c_phone, 	c_comment from 	customer, 	orders, 	lineitem, 	nation where 	c_custkey = o_custkey 	and l_orderkey = o_orderkey 	and o_orderdate >= date '1995-03-01' 	and o_orderdate < date '1995-03-01' + interval '3' month 	and l_returnflag = 'R' 	and c_nationkey = n_nationkey group by 	c_custkey, 	c_name, 	c_acctbal, 	c_phone, 	n_name, 	c_address, 	c_comment order by 	revenue desc;  
 select 	cntrycode, 	sum(c_acctbal) as totacctbal from 	( 		select 			substring(c_phone from 1 for 2) as cntrycode, 			c_acctbal 		from 			customer 		where 			substring(c_phone from 1 for 2) in 				('12', '15', '18', '21', '24', '27', '30') 			and c_acctbal > ( 				select 					avg(c_acctbal) 				from 					customer 				where 					c_acctbal > 0.00 					and substring(c_phone from 1 for 2) in 						('12', '15', '18', '21', '24', '27', '30') 			) 			and not exists ( 				select 					* 				from 					orders 				where 					o_custkey = c_custkey 			) 	) as custsale group by 	cntrycode order by 	cntrycode desc;  
 select 	cntrycode, 	sum(c_acctbal) as totacctbal from 	( 		select 			substring(c_phone from 1 for 2) as cntrycode, 			c_acctbal 		from 			customer 		where 			substring(c_phone from 1 for 2) in 				('12', '15', '18', '21', '24', '27', '30') 			and c_acctbal > ( 				select 					avg(c_acctbal) 				from 					customer 				where 					c_acctbal > 0.00 					and substring(c_phone from 1 for 2) in 						('12', '15', '18', '21', '24', '27', '30') 			) 			and exists ( 				select 					* 				from 					orders 				where 					o_custkey = c_custkey 			) 	) as custsale group by 	cntrycode order by 	cntrycode desc;  
select 	s_acctbal, 	s_name, 	n_name, 	p_partkey, 	p_mfgr, 	s_address, 	s_phone, 	s_comment from 	part, 	supplier, 	partsupp, 	nation, 	region where 	p_partkey = ps_partkey 	and s_suppkey = ps_suppkey 	and p_size = 1 	and p_type like '%STEEL' 	and s_nationkey = n_nationkey 	and n_regionkey = r_regionkey 	and r_name = 'ASIA' 	and ps_supplycost = ( 		select 			min(ps_supplycost) 		from 			partsupp, 			supplier, 			nation, 			region 		where 			p_partkey = ps_partkey 			and s_suppkey = ps_suppkey 			and s_nationkey = n_nationkey 			and n_regionkey = r_regionkey 			and r_name = 'ASIA' 	) order by 	s_acctbal desc, 	n_name asc, 	s_name asc, 	p_partkey desc;  
select 	s_acctbal, 	s_name, 	n_name, 	p_partkey, 	p_mfgr, 	s_address, 	s_phone, 	s_comment from 	part, 	supplier, 	partsupp, 	nation where 	p_partkey = ps_partkey 	and s_suppkey = ps_suppkey 	and p_size = 1 	and p_type like '%STEEL' 	and s_nationkey = n_nationkey 	and ps_supplycost = ( 		select 			min(ps_supplycost) 		from 			partsupp, 			supplier, 			nation, 			region 		where 			p_partkey = ps_partkey 			and s_suppkey = ps_suppkey 			and s_nationkey = n_nationkey 			and n_regionkey = r_regionkey 			and r_name = 'ASIA' 	) order by 	s_acctbal desc, 	n_name asc, 	s_name asc, 	p_partkey desc;  
select 	s_acctbal, 	s_name, 	n_name, 	p_partkey, 	p_mfgr, 	s_address, 	s_phone, 	s_comment from 	part, 	supplier, 	partsupp, 	nation where 	p_partkey = ps_partkey 	and s_suppkey = ps_suppkey 	and p_size = 1 	and p_type like '%STEEL' 	and s_nationkey = n_nationkey 	and p_size between 10 and 26 	and ps_supplycost = ( 		select 			min(ps_supplycost) 		from 			partsupp, 			supplier, 			nation, 			region 		where 			p_partkey = ps_partkey 			and s_suppkey = ps_suppkey 			and s_nationkey = n_nationkey 			and n_regionkey = r_regionkey 			and r_name = 'ASIA' 	) order by 	s_acctbal desc, 	n_name asc, 	s_name asc, 	p_partkey desc;  
select 	s_acctbal, 	s_name, 	n_name, 	p_partkey, 	p_mfgr, 	s_address, 	s_phone, 	s_comment from 	part, 	supplier, 	partsupp, 	nation, 	lineitem where 	p_partkey = ps_partkey 	and s_suppkey = ps_suppkey 	and ps_partkey = l_partkey 	and ps_suppkey = l_suppkey 	and l_shipdate < date '1994-01-01' 	and p_size = 1 	and p_type like '%STEEL' 	and s_nationkey = n_nationkey 	and p_size between 10 and 26 	and ps_supplycost = ( 		select 			min(ps_supplycost) 		from 			partsupp, 			supplier, 			nation, 			region 		where 			p_partkey = ps_partkey 			and s_suppkey = ps_suppkey 			and s_nationkey = n_nationkey 			and n_regionkey = r_regionkey 			and r_name = 'ASIA' 	) order by 	s_acctbal desc, 	n_name asc, 	s_name asc, 	p_partkey desc;  
select 	s_acctbal, 	s_name, 	n_name, 	p_partkey, 	p_mfgr, 	s_address, 	s_phone, 	s_comment from 	part, 	supplier, 	partsupp, 	nation, 	region where 	p_partkey = ps_partkey 	and s_suppkey = ps_suppkey 	and p_size = 1 	and p_type like '%STEEL' 	and s_nationkey = n_nationkey 	and n_regionkey = r_regionkey 	and r_name = 'ASIA' 	and ps_supplycost = ( 		select 			min(ps_supplycost) 		from 			partsupp, 			supplier, 			nation, 			region 		where 			p_partkey = ps_partkey 			and s_suppkey = ps_suppkey 			and s_nationkey = n_nationkey 			and n_regionkey = r_regionkey 			and r_name = 'ASIA' 			and n_name in ('IRAN', 'FRANCE', 'JAPAN') 	) order by 	s_acctbal desc, 	n_name asc, 	s_name asc, 	p_partkey desc;  
select 	s_acctbal, 	s_name, 	n_name, 	p_partkey, 	p_mfgr, 	s_address, 	s_phone, 	s_comment from 	part, 	supplier, 	partsupp, 	nation where 	p_partkey = ps_partkey 	and s_suppkey = ps_suppkey 	and p_size = 1 	and p_type like '%STEEL' 	and s_nationkey = n_nationkey 	and ps_availqty < 5999 	and ps_supplycost = ( 		select 			min(ps_supplycost) 		from 			partsupp, 			supplier, 			nation, 			region 		where 			p_partkey = ps_partkey 			and s_suppkey = ps_suppkey 			and s_nationkey = n_nationkey 			and n_regionkey = r_regionkey 			and ps_availqty < 5999 			and r_name = 'ASIA' 	) order by 	s_acctbal desc, 	n_name asc, 	s_name asc, 	p_partkey desc;  
 select 	nation, 	sum(case 		when nation in ('ETHIOPIA', 'VIETNAM', 'CANADA') then volume 		else 0 	end) / sum(volume) as mkt_share from 	( 		select 			l_extendedprice * (1 - l_discount) as volume, 			n2.n_name as nation 		from 			part, 			supplier, 			lineitem, 			orders, 			customer, 			nation n1, 			nation n2, 			region 		where 			p_partkey = l_partkey 			and s_suppkey = l_suppkey 			and l_orderkey = o_orderkey 			and o_custkey = c_custkey 			and c_nationkey = n1.n_nationkey 			and n1.n_regionkey = r_regionkey 			and r_name = 'ASIA' 			and s_nationkey = n2.n_nationkey 			and o_orderdate between date '1995-01-01' and date '1996-12-31' 			and p_type = 'STANDARD BRUSHED TIN' 	) as all_nations group by 	nation order by 	nation desc;  
 select 	ps_partkey, 	sum(ps_supplycost * ps_availqty) as value from 	partsupp, 	supplier, 	nation, 	lineitem where 	ps_suppkey = s_suppkey 	and s_nationkey = n_nationkey 	and n_name = 'UNITED%' 	and s_address in ('%0%', '%A%', '%a%') 	and l_shipdate < date '1995-03-01' group by 	ps_partkey having 		sum(ps_supplycost * ps_availqty) > ( 			select 				sum(ps_supplycost * ps_availqty) * 0.00004 			from 				partsupp, 				supplier, 					nation 			where 				ps_suppkey = s_suppkey 				and s_nationkey = n_nationkey 				and n_name = 'GERMANY' 		) order by 	value desc;  
 select 	ps_partkey, 	sum(ps_supplycost * ps_availqty) as value from 	partsupp, 	supplier, 	nation, 	lineitem where 	ps_suppkey = s_suppkey 	and s_nationkey = n_nationkey 	and n_name = 'UNITED%' 	and s_address in ('%0%', '%A%', '%a%') 	and l_shipdate < date '1995-03-01' 	and l_discount between 0.04 and 0.8 group by 	ps_partkey having 		sum(ps_supplycost * ps_availqty) > ( 			select 				sum(ps_supplycost * ps_availqty) * 0.00004 			from 				partsupp, 				supplier, 					nation 			where 				ps_suppkey = s_suppkey 				and s_nationkey = n_nationkey 				and n_name = 'GERMANY' 		) order by 	value desc;  
 select 	100.00 * sum(case 		when p_type like 'PROMO%' 			then l_extendedprice * (1 - l_discount) 		else 0 	end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue, 	l_shipdate from 	lineitem, 	part where 	l_partkey = p_partkey 	and l_shipdate >= date '1995-03-01' 	and l_shipdate < date '1995-03-01' + interval '1' month group by 	l_shipdate;  
 select 	100.00 * sum(case 		when p_type like 'PROMO%' 			then l_extendedprice * (1 - l_discount) 		else 0 	end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue, 	l_shipdate from 	lineitem, 	part where 	l_partkey = p_partkey 	and l_shipdate >= date '1995-03-01' 	and l_shipdate < date '1995-03-01' + interval '1' month 	and l_shipmode in ('AIR', 'FOB', 'MAIL') group by 	l_shipdate;  
 select 	c_custkey, 	c_name, 	n_name, 	sum(l_extendedprice * (1 - l_discount)) as revenue from 	customer, 	orders, 	lineitem, 	nation where 	c_custkey = o_custkey 	and l_orderkey = o_orderkey 	and l_returnflag = 'R' 	and l_shipdate < date '1995-03-01' group by 	c_custkey, 	c_name, 	c_acctbal, 	c_phone, 	n_name order by 	revenue asc;  
 select 	c_custkey, 	c_name, 	n_name, 	sum(l_extendedprice * (1 - l_discount)) as revenue from 	customer, 	orders, 	lineitem, 	nation where 	c_custkey = o_custkey 	and l_orderkey = o_orderkey 	and l_returnflag = 'R' 	and l_shipdate < date '1995-03-01' 	and n_name in ('FRANCE', 'IRAN', 'IRAQ') group by 	c_custkey, 	c_name, 	c_acctbal, 	c_phone, 	n_name order by 	revenue asc;  
 select 	c_custkey, 	c_name, 	n_name, 	sum(l_extendedprice * (1 - l_discount)) as revenue from 	customer, 	orders, 	lineitem, 	nation where 	c_custkey = o_custkey 	and l_orderkey = o_orderkey 	and l_returnflag = 'R' 	and l_shipdate < date '1995-03-01' 	and n_name in ('FRANCE', 'IRAN', 'IRAQ') 	and l_quantity < 30 group by 	c_custkey, 	c_name, 	c_acctbal, 	c_phone, 	n_name order by 	revenue asc;  
 select 	c_custkey, 	c_name, 	n_name, 	sum(l_extendedprice * (1 - l_discount)) as revenue from 	customer, 	orders, 	lineitem, 	nation where 	c_custkey = o_custkey 	and l_orderkey = o_orderkey group by 	c_custkey, 	c_name, 	c_acctbal, 	c_phone, 	n_name order by 	revenue asc;  
 select 	c_custkey, 	c_name, 	n_name, 	sum(l_extendedprice * (1 - l_discount)) as revenue from 	customer, 	orders, 	lineitem, 	nation where 	c_custkey = o_custkey 	and l_orderkey = o_orderkey 	and l_returnflag = 'R' 	and l_shipdate < date '1995-03-01' 	and n_name in ('FRANCE', 'IRAN', 'IRAQ') group by 	c_custkey, 	c_name, 	c_acctbal, 	c_phone, 	n_name order by 	revenue asc, 	c_name desc, 	n_name desc;  
 select 	l_orderkey, 	l_shipmode, 	sum(case 		when o_orderpriority = '1-URGENT' 			or o_orderpriority = '2-HIGH' 			then 1 		else 0 	end) as high_line_count, 	sum(case 		when o_orderpriority <> '1-URGENT' 			and o_orderpriority <> '2-HIGH' 			then 1 		else 0 	end) as low_line_count from 	orders, 	lineitem where 	o_orderkey = l_orderkey 	and l_shipmode in ('RAIL', 'TRUCK') 	and l_commitdate < l_receiptdate 	and l_shipdate < l_commitdate 	and l_receiptdate >= date '1995-03-01' 	and l_receiptdate < date '1995-03-01' + interval '1' year group by 	l_orderkey, 	l_shipmode order by 	l_orderkey asc, 	l_shipmode desc  LIMIT 1;  
 select 	l_orderkey, 	l_shipmode, 	sum(case 		when o_orderpriority = '1-URGENT' 			or o_orderpriority = '2-HIGH' 			then 1 		else 0 	end) as high_line_count, 	sum(case 		when o_orderpriority <> '1-URGENT' 			and o_orderpriority <> '2-HIGH' 			then 1 		else 0 	end) as low_line_count from 	orders, 	lineitem where 	o_orderkey = l_orderkey 	and l_shipmode in ('RAIL', 'TRUCK') 	and l_commitdate < l_receiptdate 	and l_receiptdate >= date '1995-03-01' 	and l_receiptdate < date '1995-03-01' + interval '1' year group by 	l_orderkey, 	l_shipmode order by 	l_orderkey asc, 	l_shipmode desc  LIMIT 1;  
 select 	l_orderkey, 	l_shipmode, 	sum(case 		when o_orderpriority = '1-URGENT' 			or o_orderpriority = '2-HIGH' 			then 1 		else 0 	end) as high_line_count, 	sum(case 		when o_orderpriority <> '1-URGENT' 			and o_orderpriority <> '2-HIGH' 			then 1 		else 0 	end) as low_line_count from 	orders, 	lineitem where 	o_orderkey = l_orderkey 	and o_orderdate < date '1995-03-01' 	and l_shipmode in ('RAIL', 'TRUCK') 	and l_commitdate < l_receiptdate 	and l_receiptdate >= date '1995-03-01' 	and l_receiptdate < date '1995-03-01' + interval '1' year group by 	l_orderkey, 	l_shipmode order by 	l_orderkey asc, 	l_shipmode desc  LIMIT 1;  
